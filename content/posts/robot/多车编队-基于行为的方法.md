---
title: "多车编队 基于行为的方法"
date: 2020-04-04T09:11:07+08:00
description: ""
draft: false
tags: [机器人,多车编队]
categories: [机器人]
---

基于行为的方法的主要思想是将编队任务转换为一系列具有特定功能的基本运动行为，这些基本运动行为是机器人运动的最小运动单位，例如，向左转、前进、奔向目标、姿态调整、蔽障、沿墙运动、目标导航等等。基于行为的方法通常由两部分组成，分别是基本**行为设计**部分和**行为选择**设计部分。对编队中的每个机器人而言，机器人的输入可以是自身传感器的探测信息，也可以是通过通信获取编队中其它某个或者多个机器人的行为输出，行为选择设计部分根据机器人输入信息使得机器人选择对应的基本行为（以一定角速度和线速度的方式）进行输出，从而使得机器人处于编队中理想的位置[^1]，具体如下图所示：

![](https://gitee.com/chengshuyi/scripts/raw/master/img/image-20200404112052576.png)

基于行为方法的编队控制包括以下三种控制方法[^2]：

1. 行为抑制法：首先对每个行为进行优先级排序，这样当无人车需要同时执行多个行为时，无人车就会按照优先级顺序执行优先级最高的行为。
2. 加权平均法：首先对每个行为规定一个对应的权值，根据对应行为的重要程度设置对应的权值。这样当无人车需要同时执行多个行为时，无人车会计算所有行为的加权求和，得到的结果经过正则化后作为无人车的行为控制；
3. 模糊逻辑法：当无人车需要同时执行多个行为时，通过查看模糊规则表，执行相对的行为控制。 

### 基于位姿误差的机器人编队基本运动行为设计[^3]

#### 机器人运动学模型

二维空间机器人位置和姿态表示为：
<div>
$$
q_0=[x_0\quad y_0\quad \theta_0]^T
$$
</div>
假设机器人当前的线速度$v_0$和角速度$\omega_0$，可得移动机器人的位姿$\dot{q}$：
<div>
$$
\dot{\boldsymbol{q}}_{0}=\left[\begin{array}{c}
\dot{x}_{0} \\
\dot{y}_{0} \\
\dot{\theta}_{0}
\end{array}\right]=\left[\begin{array}{cc}
\cos \theta_{0} & 0 \\
\sin \theta_{0} & 0 \\
0 & 1
\end{array}\right]\left[\begin{array}{l}
v_{0} \\
\omega_{0}
\end{array}\right]
$$
</div>
#### 位姿误差描述

虚拟结构仅被用以描述**目标编队的形状**和编队中虚拟机器人的固定位置，而**非限制该位置上真实存在的机器人**。如下图所示：机器人团队由领航者$q_L(x_L,y_L,\theta_L)$和跟随者$q_{F2}(x_{F2},y_{F2},\theta_{F2})$、$q_{F3}(x_{F3},y_{F3},\theta_{F3})$组成。虚线空心图形表示编队中的虚拟机器人，即跟随者$q_{F2}$和$q_{F3}$和应当抵达的位置，表示为$q_{T2}(x_{T2},y_{T2},\theta_{T2})$、$q_{T3}(x_{T3},y_{T3},\theta_{T3})$。$q_L$与$q_{T2}$、$q_{T3}$共同组成虚拟的三角形编队。设计的行为应该能够确保跟随者$q_{F2}$和$q_{F3}$到达编队中$q_{T2}$、$q_{T3}$的位置。那么可以通过$q_{F2}$和$q_{T2}$之间的位置关系描述位姿误差。

![](https://gitee.com/chengshuyi/scripts/raw/master/img/image-20200404142240713.png)

最终通过公式推导可以得到：
<div>
$$
\boldsymbol{e}_{FiTj}=\left[\begin{array}{c}
e_{FiTj}^{x} \\
e_{FiTj}^{y} \\
e_{FiTj}^{\theta}
\end{array}\right]=\left[\begin{array}{ccc}
\cos \theta_{F i} & \sin \theta_{F i} & 0 \\
-\sin \theta_{F i} & \cos \theta_{F i} & 0 \\
0 & 0 & 1
\end{array}\right]\left(\boldsymbol{q}_{T j}-\boldsymbol{q}_{F i}\right), i, j \in[2, n]
$$
</div>
上式中，$\bold{q}_{Tj}$为通过传感器或通信获取的虚拟目标机器人的位姿，$\bold{q}_{Fi}$为机器人自身的位姿信息，主要通过如GPS、编码器等传感器获得。为了使$\bold{e}_{FiTj}$处于一定的阈值内，设计了两种基本运动行为与作为基本运动行为的选择依据的三种描述性行为。两种基本行为是直线运动与旋转运动。设计的思想是首先机器人采用旋转运动面向目标，然后采用直线运动奔向目标，最后通过旋转和目标完全重合，此时机器人到达编队中虚拟机器人的位置。当所有机器人均完成此任务时，编队形成。上述思想可以归纳为转向目标，奔向目标与姿态调整三种描述性行为。

令阈值为：$\boldsymbol{\delta} = [\delta_p\quad \delta_p\quad \delta_o]^T$，$\delta_p$表示位置误差常数，$\delta_o$表示姿态角度误差常数，$T$为实际需要的有限时间。

#### 行为选择

* 转向目标

当机器人与虚拟目标之间的$y$方向误差$|e^y_{FiTj}|>\delta_p$，时，虚拟机器人$q_{Tj}$在跟随机器人$q_{Fi}$运动的正前方的时候，机器人选择奔向目标的行为。该行为同时考虑了当$q_{Fi}$背离$q_{Tj}$且两者在同一直线上的情况，此时$|e^y_{FiTj}|<\delta_p,e^x_{FiTj}<0$。该行为的触发条件：
<div>
$$
\bigcup\left\{\begin{array}{l}
\left|e_{F i T j}^{y}\right| \geq \delta_{p} \\
e_{F i T j}^{x}<-\delta_{p}\left(\left|e_{FiTj}^{y}\right|<\delta_{p}\right) i, j \in[2, n]
\end{array}\right.
$$
</div>
转向目标行为的结束条件为：
<div>
$$
\lim _{t \rightarrow t_{F i T j}^{T T}}\left|e_{F i T j}^{y}(t)\right|<\delta_{P}, \quad e_{F i T j}^{x} \geq \delta_{P}, i, j \in[2, n]
$$
</div>
* 奔向目标

当虚拟机器人$q_{Tj}$在跟随机器人$q_{Fi}$运动的正前方，即$|e^y_{FiTj}|<\delta_p$时，机器人选择奔向目标的行为。奔向目标行为用于缩短虚拟机器人$q_{Tj}$与跟随机器人$q_{Fi}$之间的直线距离。该行为的触发条件：
<div>
$$
|e^y_{FiTj}|<\delta_p, |e^x_{FiTj}|\geq\delta_p, i,j\in[2,n].
$$
</div>
奔向目标行为的结束条件为：
<div>
$$
|e^y_{FiTj}|<\delta_p, \lim _{t \rightarrow t_{F i T j}^{T T}}|e^x_{FiTj}|(t)<\delta_p, i,j\in[2,n].
$$
</div>

* 姿态调整

当虚拟机器人$q_{Tj}$与跟随机器人$q_{Fi}$之间的距离误差分量$|e^x_{FiTj}|<\delta_p$，$|e^y_{FiTj}|<\delta_p$，且两者方向误差值$|e^\theta_{FiTj}|>\delta_o$的时候，机器人选择姿态调整行为。姿态调整行为是为了让近似处于同一点上的$q_{Tj}$与$q_{Fi}$完成角度的重合。该行为的触发条件：
<div>
$$
|e^x_{FiTj}|<\delta_p, |e^y_{FiTj}|<\delta_p, |e^\theta_{FiTj}|\geq\delta_o,i,j\in[2,n].
$$
</div>
姿态调整行为的结束条件为：
<div>
$$
|e^x_{FiTj}|<\delta_p, |e^y_{FiTj}|<\delta_p, \lim _{t \rightarrow t_{F i T j}^{T T}}|e^\theta_{FiTj}|(t)<\delta_o,i,j\in[2,n].
$$
</div>
### 参考文献

[^1]: 陈传均. 多机器人领航—跟随型编队控制研究[D]. 杭州电子科技大学.
[^2]:王京.多智能体系统编队避障算法研究[D].上海:华东理工大学,2013.
[^3]: 刘磊. 多移动机器人编队及协调控制研究[D]. 华中科技大学, 2009.

